!(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})((function(a){"use strict";function b(a){return"Subject"===a?"header":"string"}function c(a,c){if(a.sol()){if(c.inSeparator=!1,c.inHeader&&a.match(f))return null;if(c.inHeader=!1,c.header=null,a.match(g))return c.inHeaders=!0,c.inSeparator=!0,"atom";var d,e=!1;return(d=a.match(i))||(e=!0)&&(d=a.match(h))?(c.inHeaders=!0,c.inHeader=!0,c.emailPermitted=e,c.header=d[1],"atom"):c.inHeaders&&(d=a.match(j))?(c.inHeader=!0,c.emailPermitted=!0,c.header=d[1],"atom"):(c.inHeaders=!1,a.skipToEnd(),null)}if(c.inSeparator)return a.match(k)?"link":a.match(l)?"atom":(a.skipToEnd(),"atom");if(c.inHeader){var o=b(c.header);if(c.emailPermitted){if(a.match(m))return o+" link";if(a.match(n))return o}return a.skipToEnd(),o}return a.skipToEnd(),null}var d=["From","Sender","Reply-To","To","Cc","Bcc","Message-ID","In-Reply-To","References","Resent-From","Resent-Sender","Resent-To","Resent-Cc","Resent-Bcc","Resent-Message-ID","Return-Path","Received"],e=["Date","Subject","Comments","Keywords","Resent-Date"];a.registerHelper("hintWords","mbox",d.concat(e));var f=/^[ \t]/,g=/^From /,h=new RegExp("^("+d.join("|")+"): "),i=new RegExp("^("+e.join("|")+"): "),j=/^[^:]+:/,k=/^[^ ]+@[^ ]+/,l=/^.*?(?=[^ ]+?@[^ ]+)/,m=/^<.*?>/,n=/^.*?(?=<.*>)/;a.defineMode("mbox",(function(){return{startState:function(){return{inSeparator:!1,inHeader:!1,emailPermitted:!1,header:null,inHeaders:!1}},token:c,blankLine:function(a){a.inHeaders=a.inSeparator=a.inHeader=!1}}})),a.defineMIME("application/mbox","mbox")}));