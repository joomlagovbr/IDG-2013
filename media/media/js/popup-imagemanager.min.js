!(function(s,a){"use strict";window.ImageManager={initialize:function(){var e=this.getUriObject(window.self.location.href),t=this.getQueryObject(e.query),i=Joomla.getOptions("mediamanager");this.author=i.author,this.base=i.base,this.asset=i.asset,this.editor=t.e_name,this.fields={url:a.getElementById("f_url"),alt:a.getElementById("f_alt"),align:a.getElementById("f_align"),title:a.getElementById("f_title"),caption:a.getElementById("f_caption"),c_class:a.getElementById("f_caption_class")},this.folderlist=a.getElementById("folderlist"),this.frame=window.frames.imageframe,this.frameurl=this.frame.location.href,s("#imageframe").on("load",(function(){ImageManager.onloadimageview()})),s("#upbutton").off("click").on("click",(function(){ImageManager.upFolder()}))},onloadimageview:function(){var e,t,i=this.getImageFolder(),a=s("#uploadForm"),r="";this.frameurl=this.frame.location.href,this.setFolder(i),e=this.getUriObject(a.prop("action")),(t=this.getQueryObject(e.query)).folder=i,e.query=s.param(t),void 0!==e.port&&80!=e.port&&(r=":"+e.port),a.prop("action",e.scheme+"://"+e.domain+r+e.path+"?"+e.query)},getImageFolder:function(){return this.getQueryObject(this.frame.location.search.substring(1)).folder},onok:function(){var e="",t=[],i="",a="",r=this.fields.url.value,s=this.fields.alt.value,o=this.fields.align.value,n=this.fields.title.value,l=this.fields.caption.value,c=this.fields.c_class.value;return r&&(t.push('alt="'+s+'"'),o&&!l&&t.push('class="pull-'+o+'"'),n&&t.push('title="'+n+'"'),e='<img src="'+r+'" '+t.join(" ")+"/>",l&&(o&&(i=' class="pull-'+o+'"'),c&&(a=' class="'+c+'"'),e="<figure"+i+">"+e+"<figcaption"+a+">"+l+"</figcaption></figure>")),window.Joomla&&Joomla.editors.instances.hasOwnProperty(this.editor)?Joomla.editors.instances[editor].replaceSelection(e):window.parent.jInsertEditorText(e,this.editor),!0},setFolder:function(e,t,i){for(var a=0,r=this.folderlist.length;a<r;a++)if(e==this.folderlist.options[a].value){this.folderlist.selectedIndex=a,s(this.folderlist).trigger("liszt:updated").trigger("chosen:updated");break}(t||i)&&this.setFrameUrl(e,t,i)},upFolder:function(){var e,t=this.folderlist.value.split("/");t.pop(),e=t.join("/"),this.setFolder(e),this.setFrameUrl(e,this.asset,this.author)},populateFields:function(i){s.each(s("a.img-preview",s("#imageframe").contents()),(function(e,t){t.href=="javascript:ImageManager.populateFields('"+i+"')"?s(t,s("#imageframe").contents()).addClass("selected"):s(t,s("#imageframe").contents()).removeClass("selected")})),s("#f_url").val(this.base+i)},showMessage:function(e){var t=s("#message");t.find(">:first-child").remove(),t.append(e),s("#messages").css("display","block")},refreshFrame:function(){this.frame.location.href=this.frameurl},setFrameUrl:function(e,t,i){var a={option:"com_media",view:"imagesList",tmpl:"component",asset:t,author:i,folder:e};this.frameurl="index.php?"+s.param(a),this.frame.location.href=this.frameurl},getQueryObject:function(e){var a={};return s.each((e||"").split(/[&;]/),(function(e,t){var i=t.split("=");a[decodeURIComponent(i[0])]=2==i.length?decodeURIComponent(i[1]):null})),a},getUriObject:function(e){var i={},a=e.match(/^(?:([^:\/?#.]+):)?(?:\/\/)?(([^:\/?#]*)(?::(\d*))?)((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[\?#]|$)))*\/?)?([^?#\/]*))?(?:\?([^#]*))?(?:#(.*))?/);return s.each(["uri","scheme","authority","domain","port","path","directory","file","query","fragment"],(function(e,t){i[t]=a&&a[e]?a[e]:""})),i}},s((function(){window.ImageManager.initialize()}))})(jQuery,document);

